# üîÑ SESSION RESTART - BREEDHUB PROJECT

## üìÖ –î–∞—Ç–∞ —Å–µ—Å—ñ—ó: 2025-09-29

## üéØ –ü–û–¢–û–ß–ù–ò–ô –°–¢–ê–ù –†–û–ë–û–¢–ò

### –©–æ —Ä–æ–±–∏–º–æ –∑–∞—Ä–∞–∑:
1. **–ó–∞–º—ñ–Ω–∞ mock –¥–∞–Ω–∏—Ö –Ω–∞ RxDB** - —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è useBreeds hook –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –∑ RxDB –∫–æ–ª–µ–∫—Ü—ñ—ó
2. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó** - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏ –∑ —ñ–Ω—à–∏–º–∏ entity types (animals, users)
3. **Sync status indicator** - –¥–æ–¥–∞–≤–∞–Ω–Ω—è —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –≤ UI

### –û—Å—Ç–∞–Ω–Ω—ñ –∑–∞–≤–µ—Ä—à–µ–Ω—ñ –∑–∞–¥–∞—á—ñ:
- ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∞ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö (EntityReplicationService)
- ‚úÖ –í–∏–¥–∞–ª–µ–Ω–æ deprecated SupabaseLoaderService
- ‚úÖ –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ realtime —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ Supabase
- ‚úÖ –ü–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–æ VirtualSpaceView ‚Üí SpaceView

### –ü–æ—Ç–æ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:
- –ü—Ä–∞—Ü—é—î —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—è –¥–ª—è entity type "breed" (–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î 100 –∑–∞–ø–∏—Å—ñ–≤ batch-–∞–º–∏)
- Mock –¥–∞–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ø–æ–ª—è: id, name, pet_profile_count, kennel_count, patron_count, achievement_progress, has_notes, avatar_url, top_patrons
- –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ mock –Ω–∞ —Ä–µ–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ –∑ RxDB –∫–æ–ª–µ–∫—Ü—ñ—ó

## üìö –ö–õ–Æ–ß–û–í–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–Ü–Ø

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ –ø–ª–∞–Ω–∏:
- `/docs/PROPERTY_BASED_CONFIG_ARCHITECTURE.md` - –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ properties
- `/docs/SPACE_STORE_ARCHITECTURE.md` - –î–µ—Ç–∞–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ SpaceStore —Ç–∞ —Ä–æ–±–æ—Ç–∞ –∑ entities
- `/docs/ENTITY_STORE_IMPLEMENTATION_PLAN.md` - –ü–ª–∞–Ω –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è Entity Store pattern
- `/docs/STORE_ARCHITECTURE.md` - –ó–∞–≥–∞–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ store —Å–∏—Å—Ç–µ–º–∏
- `/docs/DYNAMIC_VIEW_ROWS_IMPLEMENTATION.md` - –ü–ª–∞–Ω —Ä–æ–±–æ—Ç–∏ –∑ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º–∏ views —Ç–∞ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—î—é
- `/docs/STORE_CREATION_GUIDE.md` - –ì–∞–π–¥ –ø–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—é stores

### –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ:
- `/docs/RXDB_INTEGRATION.md` - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ RxDB
- `/docs/SUPABASE_SYNC.md` - –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ Supabase (—è–∫—â–æ —î)

## üîß –û–°–ù–û–í–ù–Ü –§–ê–ô–õ–ò –î–õ–Ø –†–û–ë–û–¢–ò

### Stores —ñ –°–µ—Ä–≤—ñ—Å–∏:
```
/packages/rxdb-store/src/
‚îú‚îÄ‚îÄ stores/
‚îÇ   ‚îú‚îÄ‚îÄ space-store.signal-store.ts    # –û—Å–Ω–æ–≤–Ω–∏–π store –¥–ª—è entities
‚îÇ   ‚îú‚îÄ‚îÄ app-store.signal-store.ts      # App store
‚îÇ   ‚îî‚îÄ‚îÄ base/entity-store.ts           # –ë–∞–∑–æ–≤–∏–π EntityStore –∫–ª–∞—Å
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ entity-replication.service.ts  # –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤—ñ—Å —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó
‚îÇ   ‚îî‚îÄ‚îÄ database.service.ts            # RxDB database service
```

### UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:
```
/apps/app/src/
‚îú‚îÄ‚îÄ components/space/
‚îÇ   ‚îú‚îÄ‚îÄ SpaceComponent.tsx     # –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ—Å—Ç–æ—Ä—É
‚îÇ   ‚îú‚îÄ‚îÄ SpaceView.tsx          # View –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è entities
‚îÇ   ‚îî‚îÄ‚îÄ ViewChanger.tsx        # –ü–µ—Ä–µ–º–∏–∫–∞—á views
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useBreeds.ts           # Hook –∑ mock –¥–∞–Ω–∏–º–∏ (–ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏)
‚îú‚îÄ‚îÄ mocks/
‚îÇ   ‚îî‚îÄ‚îÄ breeds.mock.ts         # Mock –¥–∞–Ω—ñ breeds
```

## üöÄ –ö–û–ú–ê–ù–î–ò –î–õ–Ø –ó–ê–ü–£–°–ö–£

```bash
# –û—Å–Ω–æ–≤–Ω–∏–π dev server
npm run dev

# –ê–±–æ –æ–∫—Ä–µ–º–æ app
cd apps/app
pnpm run dev:app

# –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ—á–∏—Å—Ç–∏—Ç–∏
rm -rf node_modules
npm install
```

## üîç –í–ê–ñ–õ–ò–í–Ü –î–ï–¢–ê–õ–Ü –†–ï–ê–õ–Ü–ó–ê–¶–Ü–á

### EntityReplicationService:
- Pull handler –∑ checkpoint –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º
- Batch size: 100 –∑–∞–ø–∏—Å—ñ–≤
- Pull interval: 5 —Å–µ–∫—É–Ω–¥ (–¥–ª—è development)
- Realtime subscription —á–µ—Ä–µ–∑ Supabase channels
- Conflict resolution: last-write-wins
- –ú–∞–ø—ñ–Ω–≥ –ø–æ–ª—ñ–≤: `deleted` ‚Üî `_deleted`

### SpaceStore:
- –î–∏–Ω–∞–º—ñ—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è RxDB —Å—Ö–µ–º –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- –ú–µ—Ç–æ–¥ `setupEntityReplication()` –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó
- –ó–±–µ—Ä—ñ–≥–∞—î entity stores –≤ Map —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ
- –ü—Ä–∞—Ü—é—î –∑ signals –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –ü–æ—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∑ mock –¥–∞–Ω–∏–º–∏:
`useBreeds` hook –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î mock –¥–∞–Ω—ñ –∑–∞–º—ñ—Å—Ç—å RxDB. –ü–æ—Ç—Ä—ñ–±–Ω–æ:
1. –ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ RxDB –∫–æ–ª–µ–∫—Ü—ñ—é `breed`
2. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –≤ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç
3. –ó–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

## üìù TODO –ü–Ü–°–õ–Ø –†–ï–°–¢–ê–†–¢–£

1. **–ù–µ–≥–∞–π–Ω–æ**: –ó–∞–º—ñ–Ω–∞ mock –¥–∞–Ω–∏—Ö –Ω–∞ RxDB –≤ useBreeds
2. **–î–∞–ª—ñ**: –î–∏–Ω–∞–º—ñ—á–Ω—ñ rows –∑ view –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
3. **–ü–æ—Ç—ñ–º**: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ —ñ–Ω—à–∏–º–∏ entity types
4. **–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ**: Sync status indicator

## üêõ –í–Ü–î–û–ú–Ü –ü–†–û–ë–õ–ï–ú–ò

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ 100 breeds –∑–∞–º—ñ—Å—Ç—å 452 (batch limitation - –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
2. Mock –¥–∞–Ω—ñ –≤—Å–µ —â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ UI
3. –î–∏–Ω–∞–º—ñ—á–Ω—ñ rows –ø–æ–∫–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–¥–∂–µ–Ω—ñ –Ω–∞ 50

## üí° –ö–û–†–ò–°–ù–Ü –ù–û–¢–ê–¢–ö–ò

- –†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∫–æ–ª–µ–∫—Ü—ñ—ó
- –î–∞–Ω—ñ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—é—Ç—å—Å—è –≤ –æ–±–∏–¥–≤–∞ –±–æ–∫–∏ (RxDB ‚Üî Supabase)
- Realtime –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—é—Ç—å —á–µ—Ä–µ–∑ Supabase channels
- –í—Å—ñ –∑–º—ñ–Ω–∏ –≤ RxDB –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—é—Ç—å—Å—è

## üîó GITHUB BRANCH

–ü–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞: `debug/ui-cascade-issue`

## üìå –ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø AI –ê–°–ò–°–¢–ï–ù–¢–ê

–ü—Ä–∏ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—ñ —Ä–æ–±–æ—Ç–∏, –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É –Ω–∞:
1. –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è: EntityStore –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —á–∏—Å—Ç–∏–º, SpaceStore –∫–µ—Ä—É—î —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—î—é
2. –ü–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö: Supabase ‚Üî EntityReplicationService ‚Üî RxDB ‚Üî SpaceStore ‚Üí EntityStore ‚Üí UI
3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Preact signals –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
4. Batch processing –ø–æ 100 –∑–∞–ø–∏—Å—ñ–≤ - —Ü–µ –û–ö, –Ω–µ —Ç—Ä–µ–±–∞ —Ñ—ñ–∫—Å–∏—Ç–∏

---

**–û—Å—Ç–∞–Ω–Ω—ñ–π –∫–æ–º—ñ—Ç**: "refactor: remove deprecated loader and improve replication performance"

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç—É**: –†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î, –ø–æ—Ç—Ä—ñ–±–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ UI —á–µ—Ä–µ–∑ RxDB –∑–∞–º—ñ—Å—Ç—å mock –¥–∞–Ω–∏—Ö.